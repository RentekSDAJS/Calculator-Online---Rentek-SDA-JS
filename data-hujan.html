<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekap Data Hujan - SDA Jaksel</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
        .container { max-width: 600px; margin: 0 auto; }
        h2 { color: #333; }
        .controls { margin-bottom: 20px; background: #eee; padding: 15px; border-radius: 5px; }
        select { padding: 8px; width: 100%; font-size: 16px; margin-top: 10px; }
        
        /* Gaya tabel agar rapi saat di-copy ke Excel */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #000; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; }
        
        .btn-copy-info { font-size: 12px; color: #666; margin-bottom: 10px; display: block; }
        .back-link { text-decoration: none; color: blue; font-size: 14px; }
    </style>
</head>
<body>

<div class="container">
    <a href="index.html" class="back-link">‚Üê Kembali ke Dashboard</a>
    <h2>Rekap Tahunan Per Stasiun</h2>
    
    <div class="controls">
        <label>Pilih Stasiun:</label>
        <select id="stationSelect" onchange="loadRekap()">
            </select>
    </div>

    <span class="btn-copy-info">* Anda bisa langsung blok tabel di bawah dan Copy (Ctrl+C) ke Excel.</span>
    
    <div id="rekapArea">
        <p>Memuat database...</p>
    </div>
</div>

<script>
    let rawData = [];
    const stationNames = [
        "Kemayoran", "Halim", "Bogor", "Banten", "Katulampa", "Depok", "Manggarai", "Karet", 
        "Setiabudi Timur", "Melati", "Istana", "Krukut Hulu", "Sunter Hulu", "Pesanggrahan", 
        "Angke Hulu", "Tanjungan", "Tomang Barat", "Teluk Gong", "Pulo Gadung", 
        "Sunter Kodamar", "Sunter III Rawa Badak", "Pompa Cideng"
    ];

    async function init() {
        try {
            const resp = await fetch('data/hujan/all-data.json');
            rawData = await resp.json();
            
            // Urutkan data berdasarkan tahun 2000 ke atas
            rawData.sort((a, b) => a.tahun - b.tahun);

            const select = document.getElementById('stationSelect');
            stationNames.forEach((name, i) => {
                let opt = document.createElement('option');
                opt.value = `st_${(i+1).toString().padStart(2, '0')}`;
                opt.textContent = name;
                select.appendChild(opt);
            });

            loadRekap();
        } catch (e) {
            document.getElementById('rekapArea').innerHTML = "Gagal mengambil file all-data.json";
        }
    }

    function loadRekap() {
        const key = document.getElementById('stationSelect').value;
        const name = document.getElementById('stationSelect').options[document.getElementById('stationSelect').selectedIndex].text;
        
        let tableHtml = `
            <table>
                <thead>
                    <tr>
                        <th>Tahun</th>
                        <th>${name} (mm)</th>
                    </tr>
                </thead>
                <tbody>
        `;

        rawData.forEach(item => {
            tableHtml += `
                <tr>
                    <td>${item.tahun}</td>
                    <td>${item[key] || 0}</td>
                </tr>
            `;
        });

        tableHtml += `</tbody></table>`;
        document.getElementById('rekapArea').innerHTML = tableHtml;
    }

    window.onload = init;
</script>

</body>
</html>
